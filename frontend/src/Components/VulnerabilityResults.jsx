
import React from "react";
import "./VulnerabilityResults.css";

function getSeverityStyle(severity) {
  switch (severity?.toLowerCase()) {
    case "critical":
    case "high":
      return { card: "card-high-critical", label: "label-high-critical" };
    case "medium":
      return { card: "card-medium", label: "label-medium" };
    case "low":
      return { card: "card-low", label: "label-low" };
    default:
      return { card: "card-unknown", label: "label-unknown" };
  }
}

function VulnerabilityResults({ results, onViewDetails }) {
  if (!results || results.length === 0) {
    return (
      <div className="empty-results">
        <p>âœ… No vulnerabilities found yet.</p>
      </div>
    );
  }

  return (
    <div className="vuln-results-container">
      <h2 className="results-title">Vulnerability Results</h2>
      <div className="vuln-cards-grid">
        {results.map((v, index) => {
          const style = getSeverityStyle(v.severity);
          return (
            <div
              key={v.id || index}
              className={`vuln-card ${style.card}`}
              onClick={() => onViewDetails && onViewDetails(v)}
            >
              <div className="vuln-header">
                <h3 className="vuln-name">{v.name || "Unnamed Vulnerability"}</h3>
                <span className={`severity-label ${style.label}`}>
                  {v.severity?.toUpperCase() || "UNKNOWN"}
                </span>
              </div>
              {v.location && <p className="vuln-location">Location: {v.location}</p>}
              <p className="vuln-description">{v.description || "No description available."}</p>
              {v.fix && (
                <p className="vuln-fix">
                  <strong>Fix:</strong> {v.fix}
                </p>
              )}
              <button
                className="view-details-btn"
                onClick={(e) => {
                  e.stopPropagation();
                  onViewDetails && onViewDetails(v);
                }}
              >
                View Details &gt;
              </button>
            </div>
          );
        })}
      </div>
    </div>
  );
}

export default VulnerabilityResults;
